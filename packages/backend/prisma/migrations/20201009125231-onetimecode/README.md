# Migration `20201009125231-onetimecode`

This migration has been generated by Zane Helton at 10/9/2020, 8:52:31 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."OneTimeCode" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL ,
"expired" boolean   NOT NULL DEFAULT false,
"fileId" text   NOT NULL ,
"code" text   NOT NULL ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."OneTimeCode" ADD FOREIGN KEY ("fileId")REFERENCES "public"."File"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201008204431-expires-at-instead-of-days..20201009125231-onetimecode
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgres"
-  url = "***"
+  url = "***"
 }
 enum AccountType {
   FREE
@@ -139,15 +139,16 @@
   url        String   @unique
 }
 model File {
-  id         String   @id @default(uuid())
-  createdAt  DateTime @default(now())
-  isArchived Boolean  @default(false)
-  name       String
-  secret     String   @unique
-  url        String   @unique
-  product    Product
+  id           String        @id @default(uuid())
+  createdAt    DateTime      @default(now())
+  isArchived   Boolean       @default(false)
+  name         String
+  secret       String        @unique
+  url          String        @unique
+  product      Product
+  oneTimeCodes OneTimeCode[]
 }
 model PromoCode {
   id           String        @id @default(uuid())
@@ -189,6 +190,16 @@
 model Ad {
   id        String   @id @default(uuid())
   createdAt DateTime @default(now())
   expiresAt DateTime
-  product   Product
-}
+  product   Product  @relation(fields: [productId], references: [id])
+  productId String
+}
+
+model OneTimeCode {
+  id        String   @id @default(uuid())
+  createdAt DateTime
+  expired   Boolean  @default(false)
+  file      File     @relation(fields: [fileId], references: [id])
+  fileId    String
+  code      String
+}
```


