# Migration `20200901142525-to-uuid`

This migration has been generated by Zane Helton at 9/1/2020, 10:25:25 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Product" DROP CONSTRAINT "Product_ownerId_fkey"

ALTER TABLE "public"."Review" DROP CONSTRAINT "Review_authorId_fkey"

ALTER TABLE "public"."Review" DROP CONSTRAINT "Review_productId_fkey"

ALTER TABLE "public"."Tag" DROP CONSTRAINT "Tag_creatorId_fkey"

ALTER TABLE "public"."Transaction" DROP CONSTRAINT "Transaction_buyerId_fkey"

ALTER TABLE "public"."Transaction" DROP CONSTRAINT "Transaction_productId_fkey"

ALTER TABLE "public"."_ProductToTag" DROP CONSTRAINT "_ProductToTag_A_fkey"

ALTER TABLE "public"."_ProductToTag" DROP CONSTRAINT "_ProductToTag_B_fkey"

ALTER TABLE "public"."Product" DROP CONSTRAINT "Product_pkey",
ALTER COLUMN "id" SET DATA TYPE text ,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "ownerId" SET DATA TYPE text ,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "Product_id_seq"

ALTER TABLE "public"."Review" DROP CONSTRAINT "Review_pkey",
ALTER COLUMN "id" SET DATA TYPE text ,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "productId" SET DATA TYPE text ,
ALTER COLUMN "authorId" SET DATA TYPE text ,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "Review_id_seq"

ALTER TABLE "public"."Tag" DROP CONSTRAINT "Tag_pkey",
ALTER COLUMN "id" SET DATA TYPE text ,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "creatorId" SET DATA TYPE text ,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "Tag_id_seq"

ALTER TABLE "public"."Transaction" DROP CONSTRAINT "Transaction_pkey",
ALTER COLUMN "id" SET DATA TYPE text ,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "buyerId" SET DATA TYPE text ,
ALTER COLUMN "productId" SET DATA TYPE text ,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "Transaction_id_seq"

ALTER TABLE "public"."User" DROP CONSTRAINT "User_pkey",
ALTER COLUMN "id" SET DATA TYPE text ,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "id" DROP DEFAULT,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "User_id_seq"

ALTER TABLE "public"."_ProductToTag" ALTER COLUMN "A" SET DATA TYPE text ,
ALTER COLUMN "B" SET DATA TYPE text 

ALTER TABLE "public"."Product" ADD FOREIGN KEY ("ownerId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Review" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Review" ADD FOREIGN KEY ("productId")REFERENCES "public"."Product"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Tag" ADD FOREIGN KEY ("creatorId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Transaction" ADD FOREIGN KEY ("buyerId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Transaction" ADD FOREIGN KEY ("productId")REFERENCES "public"."Product"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."_ProductToTag" ADD FOREIGN KEY ("A")REFERENCES "public"."Product"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ProductToTag" ADD FOREIGN KEY ("B")REFERENCES "public"."Tag"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200901105703-add-message-to-review..20200901142525-to-uuid
--- datamodel.dml
+++ datamodel.dml
@@ -3,13 +3,13 @@
 }
 datasource db {
   provider = "postgres"
-  url = "***"
+  url = "***"
 }
 model User {
-  id            Int           @default(autoincrement()) @id
+  id            String        @default(uuid()) @id
   createdAt     DateTime      @default(now())
   createdTags   Tag[]
   displayName   String?
   email         String        @unique
@@ -26,48 +26,48 @@
   emailUpdates Boolean @default(true)
 }
 model Product {
-  id           Int           @default(autoincrement()) @id
+  id           String        @default(uuid()) @id
   amount       Float         @default(0)
   createdAt    DateTime      @default(now())
   description  String
   name         String
   owner        User?         @relation(fields: [ownerId], references: [id])
-  ownerId      Int?
+  ownerId      String?
   reviews      Review[]
   tags         Tag[]
   transactions Transaction[]
   updatedAt    DateTime      @updatedAt
 }
 model Transaction {
-  id        Int      @default(autoincrement()) @id
+  id        String   @default(uuid()) @id
   amount    Float    @default(0)
   buyer     User     @relation(fields: [buyerId], references: [id])
-  buyerId   Int
+  buyerId   String
   createdAt DateTime @default(now())
   product   Product? @relation(fields: [productId], references: [id])
-  productId Int?
+  productId String?
   updatedAt DateTime @updatedAt
 }
 model Tag {
-  id        Int       @default(autoincrement()) @id
+  id        String    @default(uuid()) @id
   createdAt DateTime  @default(now())
   creator   User      @relation(fields: [creatorId], references: [id])
-  creatorId Int
+  creatorId String
   name      String
   products  Product[]
 }
 model Review {
-  id        Int      @default(autoincrement()) @id
+  id        String   @default(uuid()) @id
   author    User     @relation(fields: [authorId], references: [id])
-  authorId  Int
+  authorId  String
   createdAt DateTime @default(now())
   message   String
   product   Product  @relation(fields: [productId], references: [id])
-  productId Int
+  productId String
   stars     Int
   updatedAt DateTime @updatedAt
 }
```


